<!doctype html>
<html>
    <head>
        <title>sketch.js &raquo; Basic Example</title>
        <!-- <link rel="stylesheet" href="css/example.css"> -->
        <link rel="stylesheet" type="text/css" href="../css/silk.css">
        <style type="text/css">
            html, body {
                background: rgb(197, 157, 204);
            }
        </style>
    </head>
    <body style="overflow:hidden">
        <div class="blurb">
            <div class="title">Solver-Based Animation</div>
            <div class="description">Ceres Solver tries to maintain a fixed distance between the cursor and a circle.</div>
        </div>

        <div class="navigation">
            <a href="../">Top</a> / <a href="../about.html">About</a>
        </div>

        <div id="container"></div>
        <script src="js/sketch.js"></script>
        <script src="helloworld.js"></script>
        <script>

            var circle = {x: -100, y: -100};
            var radius = 30;
            var thickness = 10;
            var solver;

            Sketch.create({
                container: document.getElementById( 'container' ),
                setup: function() {
                    solver = new Module.AvoiderSolver;
                },
                touchmove: function() {
                    solver.goal_pose = [this.touches[0].x, this.touches[0].y];
                    solver.stepSolve(10);
                    circle.x = solver.current_pose[0];
                    circle.y = solver.current_pose[1];
                },
                draw: function() {
                    // draw line from cursor to annulus
                    this.beginPath();
                    this.lineWidth = 2*thickness;
                    this.strokeStyle = '#333333';
                    this.lineCap = 'round';
                    this.moveTo(circle.x, circle.y);
                    this.lineTo(this.touches[0].x, this.touches[0].y);
                    this.stroke();
                    // draw annulus that avoids the cursor
                    this.beginPath();
                    this.arc( circle.x, circle.y, radius + thickness, 0, TWO_PI );
                    this.lineWidth = thickness;
                    this.globalAlpha = 0.5;
                    this.strokeStyle = '#CCCCCC';
                    this.stroke();
                }
            })

        </script>
    </body>
</html>
